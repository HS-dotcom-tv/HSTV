<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HSTV - Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    /* ---------------------------------- */
    /* 1. ØªØ¹Ø±ÙŠÙ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† (Themes) */
    /* ---------------------------------- */
    :root {
        /* -- Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ (Ø§Ù„Ø£Ø²Ø±Ù‚ ÙˆØ§Ù„Ø£Ø®Ø¶Ø±) -- */
        --bg-gradient-start: #0f172a;
        --bg-gradient-end: #1e293b;
        --text-main: #fff;
        --text-secondary: #94a3b8;
        --card-bg: rgba(30, 41, 59, 0.4);
        --card-hover-bg: rgba(30, 41, 59, 0.75);
        --card-border: #334155;
        --btn-bg: #1e293b;
        --btn-text: #cbd5e1;
        --btn-active-gradient-start: #10b981;
        --btn-active-gradient-end: #06b6d4;
        --btn-active-text: #fff;
        --header-gradient-start: #10b981;
        --header-gradient-end: #06b6d4;
    }

    body.dark-mode {
        /* -- Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ (Ø§Ù„Ø£Ø³ÙˆØ¯ ÙˆØ§Ù„Ø°Ù‡Ø¨ÙŠ) -- */
        --bg-gradient-start: #111827;
        --bg-gradient-end: #1F2937;
        --text-main: #E5E7EB;
        --text-secondary: #9CA3AF;
        --card-bg: rgba(31, 41, 55, 0.4);
        --card-hover-bg: rgba(55, 65, 81, 0.6);
        --card-border: #374151;
        --btn-bg: #374151;
        --btn-text: #D1D5DB;
        --btn-active-gradient-start: #FBBF24;
        --btn-active-gradient-end: #F59E0B;
        --btn-active-text: #111827;
        --header-gradient-start: #FBBF24;
        --header-gradient-end: #F59E0B;
    }
    
    /* ---------------------------------- */
    /* 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„ØªØµÙ…ÙŠÙ…   */
    /* ---------------------------------- */
    body { 
        font-family: 'Cairo', sans-serif; 
        background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end)); 
        min-height:100vh; 
        color: var(--text-main);
        transition: background 0.3s ease;
    }
    .match-card { 
        transition: all .2s; 
        backdrop-filter: blur(6px); 
        background: var(--card-bg);
        border: 1px solid var(--card-border);
    }
    .match-card:hover { 
        transform: translateY(-4px); 
        background: var(--card-hover-bg); 
    }
    .btn-tab.active { 
        background: linear-gradient(90deg, var(--btn-active-gradient-start), var(--btn-active-gradient-end)); 
        font-weight:700; 
        color: var(--btn-active-text);
        border: none;
    }
    .btn-tab { 
        background: var(--btn-bg); 
        color: var(--btn-text);
        border: 1px solid var(--card-border);
    }
    .crest { 
        width: 50px; height: 50px; object-fit: contain; margin: auto;
        border-radius: 50%; box-shadow: inset 0 0 0 1px rgba(100, 116, 139, 0.5);
    }
    h1 {
        background: linear-gradient(45deg, var(--header-gradient-start), var(--header-gradient-end)); 
        -webkit-background-clip: text; 
        color: transparent;
    }
    .team-name { font-size: 0.85rem; font-weight: 600; text-align:center; line-height:1.2; word-break: break-word; }
    .status-text { font-size: 0.8rem; color: var(--text-secondary); text-align:center; }
    .score-box { font-size: 1.4rem; font-weight: 700; text-align:center; line-height: 1; color: var(--text-main);}
    .match-details {
      border-top: 1px solid var(--card-border); margin-top: 1rem; padding-top: 0.75rem;
      font-size: 0.8rem; color: var(--text-secondary); display: flex;
      justify-content: space-between; align-items: center;
    }
    .time-period {
        display: block; font-size: 0.7rem; font-weight: 400;
        color: var(--text-secondary); opacity: 0.8; margin-top: 2px;
    }
    /* ØªØµÙ…ÙŠÙ… Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
    #theme-toggle {
        background: var(--btn-bg); border: 1px solid var(--card-border);
        border-radius: 999px; padding: 0.5rem; color: var(--btn-text);
        cursor: pointer; transition: all 0.2s ease;
    }
    #theme-toggle:hover {
        background: var(--card-hover-bg);
    }
  </style>
  
  <script>
    // Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„ØµØºÙŠØ± ÙŠØ¹Ù…Ù„ Ø£ÙˆÙ„ Ø´ÙŠØ¡ Ù„ÙŠÙ…Ù†Ø¹ "ÙˆÙ…Ø¶Ø©" ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ¶Ø¹ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    // ÙˆÙŠØªØ£ÙƒØ¯ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØµØ­ÙŠØ­ Ø§Ù„Ø°ÙŠ Ø­ÙØ¸Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙˆØ±Ù‹Ø§
    (function() {
      if (localStorage.getItem('theme') === 'dark') {
        document.body.classList.add('dark-mode');
      }
    })();
  </script>
</head>
<body class="p-4">
  <header class="text-center mb-6 relative">
    <h1 class="text-4xl font-bold">HSTV</h1>
    <p class="text-slate-400 mt-1">Ø£Ù‡Ù… Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„Ø£Ù…Ø³ ÙˆØ§Ù„ØºØ¯</p>
    
    <div class="absolute top-0 left-0">
        <button id="theme-toggle" title="ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ¶Ø¹">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
            </svg>
        </button>
    </div>
  </header>

  <div class="max-w-3xl mx-auto mb-6">
    <div class="flex gap-3">
      <button id="yesterday" class="btn-tab flex-1 px-4 py-2 rounded-xl">Ø§Ù„Ø£Ù…Ø³</button>
      <button id="today" class="btn-tab flex-1 px-4 py-2 rounded-xl active">Ø§Ù„ÙŠÙˆÙ…</button>
      <button id="tomorrow" class="btn-tab flex-1 px-4 py-2 rounded-xl">Ø§Ù„ØºØ¯</button>
    </div>
  </div>
  <main id="matches" class="max-w-3xl mx-auto space-y-4"></main>
  
  <script>
    const API_URL = 'matches.json';
    const matchesContainer = document.getElementById('matches');
    const leagueTranslations = {
      'PL': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ', 'CL': 'Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§', 'EC': 'Ø¨Ø·ÙˆÙ„Ø© Ø£Ù…Ù… Ø£ÙˆØ±ÙˆØ¨Ø§', 'WC': 'ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…',
      'PD': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ', 'BL1': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ', 'SA': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ', 'FL1': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ',
      'PPL': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¨Ø±ØªØºØ§Ù„ÙŠ', 'DED': 'Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ù‡ÙˆÙ„Ù†Ø¯ÙŠ'
    };
    const brokenLogos = { '113': true, };

    // --- ÙƒÙˆØ¯ ØªØ´ØºÙŠÙ„ Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ---
    const themeToggle = document.getElementById('theme-toggle');
    themeToggle.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        // Ø­ÙØ¸ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        if (document.body.classList.contains('dark-mode')) {
            localStorage.setItem('theme', 'dark');
        } else {
            localStorage.setItem('theme', 'light');
        }
    });
    // --- Ù†Ù‡Ø§ÙŠØ© ÙƒÙˆØ¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø²Ø± ---

    function setActiveTab(id) { document.querySelectorAll('.btn-tab').forEach(b => b.classList.remove('active')); document.getElementById(id).classList.add('active'); }
    function getDateString(offset = 0) { const d = new Date(); d.setDate(d.getDate() + offset); return d.toISOString().split('T')[0]; }
    
    function formatTime(iso) {
        const d = new Date(iso);
        let timeString = d.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true, timeZone: 'Asia/Riyadh' });
        timeString = timeString.replace('AM', 'ØµØ¨Ø§Ø­Ù‹Ø§').replace('PM', 'Ù…Ø³Ø§Ø¡Ù‹');
        return timeString;
    }

    async function loadMatches(view='today') {
      setActiveTab(view);
      matchesContainer.innerHTML = `<div class="text-center py-12 text-slate-400">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª...</div>`;
      try {
        const res = await fetch(API_URL + '?t=' + Date.now());
        const data = await res.json();
        renderMatches(data.response || [], view);
      } catch (err) { matchesContainer.innerHTML = `<div class="text-center py-12 text-red-400">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>`; }
    }

    function renderMatches(allMatches, view) {
      matchesContainer.innerHTML = '';
      const offset = view === 'yesterday' ? -1 : view === 'tomorrow' ? 1 : 0;
      const target = getDateString(offset);
      let filtered = allMatches.filter(m => m.fixture.date && m.fixture.date.startsWith(target));
      if (!filtered.length) { matchesContainer.innerHTML = `<div class="text-center py-12 text-slate-400">âš½ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…</div>`; return; }
      filtered.forEach(match => { matchesContainer.innerHTML += renderMatchHTML(match); });
    }

    function renderMatchHTML(match) {
      const status = match.fixture.status.short || 'NS';
      let centerTop = '', centerBottom = '';
      if (["LIVE", "HT"].includes(status)) {
        centerTop = `<div class="score-box text-emerald-400">${match.goals.home ?? 0} - ${match.goals.away ?? 0}</div>`;
        centerBottom = `<div class="status-text text-red-400">Ù…Ø¨Ø§Ø´Ø±</div>`;
      } else if (["FT", "AET", "PEN"].includes(status)) {
        centerTop = `<div class="score-box">${match.goals.home ?? 0} - ${match.goals.away ?? 0}</div>`;
        centerBottom = `<div class="status-text">Ø§Ù†ØªÙ‡Øª</div>`;
      } else {
        const formattedTime = formatTime(match.fixture.date);
        const timeParts = formattedTime.split(' ');
        centerTop = `<div class="score-box">${timeParts[0]}<span class="time-period">${timeParts[1]}</span></div>`;
      }
      const leagueNameAr = leagueTranslations[match.league.code] || match.league.name;
      const competitionInfo = `<div class="match-details"><span>ğŸ† ${leagueNameAr}</span><span>ğŸŸï¸ ${match.fixture.venue || 'Ù…Ù„Ø¹Ø¨ ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span></div>`;
      const homeLogo = brokenLogos[match.teams.home.id] ? 'default-logo.svg' : (match.teams.home.logo || 'default-logo.svg');
      const awayLogo = brokenLogos[match.teams.away.id] ? 'default-logo.svg' : (match.teams.away.logo || 'default-logo.svg');
      return `<div class="match-card border border-slate-700 rounded-xl p-4"><div class="grid grid-cols-3 items-center text-center"><div><img src="${homeLogo}" class="crest" onerror="this.src='default-logo.svg';"></div><div>${centerTop}</div><div><img src="${awayLogo}" class="crest" onerror="this.src='default-logo.svg';"></div></div><div class="grid grid-cols-3 items-center text-center mt-2"><div class="team-name">${match.teams.home.name}</div><div>${centerBottom}</div><div class="team-name">${match.teams.away.name}</div></div>${competitionInfo}</div>`;
    }

    ['yesterday', 'today', 'tomorrow'].forEach(id => document.getElementById(id).addEventListener('click', () => loadMatches(id)));
    loadMatches('today');
    setInterval(() => { if (document.getElementById('today').classList.contains('active')) loadMatches('today'); }, 60000);
  </script>
</body>
</html>
